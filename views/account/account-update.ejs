<% if (title) { %>

    <h1 class="text-3xl font-bold mb-6 text-center">
        <%= title %>
    </h1>
    <% } else { res.redirect('/') } %>

        <%# NOTE: We use 'notice' or 'messages' here based on convention, but 'notice' is standard %>
            <%# If you are passing 'notice' from the controller, you should display it like this: %>
                <% if (notice && notice.length> 0) { %>
                    <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4" role="alert">
                        <p class="font-bold">Notice:</p>
                        <p>
                            <%= notice %>
                        </p>
                    </div>
                    <% } %>


                        <% if (errors && errors.length> 0) { %>
                            <ul
                                class="notice bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 list-disc ml-6">
                                <% errors.forEach(error=> { %>
                                    <%# *** THIS IS THE CRITICAL FIX: Accessing error.msg *** %>
                                        <li>
                                            <%= error.msg %>
                                        </li>
                                        <% }) %>
                            </ul>
                            <% } %>

                                <!-- ****************************************


FORM 1: Account Information Update
**************************************** -->

                                <div
                                    class="bg-white p-6 rounded-xl shadow-lg mb-8 max-w-lg mx-auto border border-gray-200">
                                    <h2 class="text-xl font-semibold mb-4 text-gray-800">Update Account Information</h2>

                                    <p class="mb-4 text-sm text-gray-600">
                                        Use this form to update your name and email address.
                                    </p>

                                    <form id="updateAccountForm" action="/account/update" method="post"
                                        class="space-y-4">

                                        <div class="flex flex-col">
                                            <label for="account_firstname"
                                                class="text-sm font-medium text-gray-700 mb-1">First
                                                Name</label>
                                            <input type="text" id="account_firstname" name="account_firstname" required
                                                value="<%= account_firstname %>"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>

                                        <div class="flex flex-col">
                                            <label for="account_lastname"
                                                class="text-sm font-medium text-gray-700 mb-1">Last
                                                Name</label>
                                            <input type="text" id="account_lastname" name="account_lastname" required
                                                value="<%= account_lastname %>"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>

                                        <div class="flex flex-col">
                                            <label for="account_email"
                                                class="text-sm font-medium text-gray-700 mb-1">Email
                                                Address</label>
                                            <input type="email" id="account_email" name="account_email" required
                                                value="<%= account_email %>"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>

                                        <input type="hidden" name="account_id" value="<%= account_id %>">

                                        <button type="submit"
                                            class="w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-150 ease-in-out">
                                            Update Account
                                        </button>
                                    </form>


                                </div>

                                <!-- ****************************************


FORM 2: Password Change
**************************************** -->

                                <div class="bg-white p-6 rounded-xl shadow-lg max-w-lg mx-auto border border-gray-200">
                                    <h2 class="text-xl font-semibold mb-4 text-gray-800">Change Password</h2>
                                    <p class="mb-4 text-sm text-gray-600">
                                        Changing your password will require you to log back in. Password must meet the
                                        following
                                        criteria: At least 12 characters and contain at least 1 number, 1 capital letter
                                        and
                                        1
                                        special character.
                                    </p>

                                    <form id="changePasswordForm" action="/account/change-password" method="post"
                                        class="space-y-4">

                                        <div class="flex flex-col">
                                            <label for="current_password"
                                                class="text-sm font-medium text-gray-700 mb-1">Current
                                                Password</label>
                                            <input type="password" id="current_password" name="current_password"
                                                required
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                                        </div>

                                        <div class="flex flex-col">
                                            <label for="new_password" class="text-sm font-medium text-gray-700 mb-1">New
                                                Password</label>
                                            <input type="password" id="new_password" name="new_password" required
                                                pattern="^(?=.*\d)(?=.*[A-Z])(?=.*[^a-zA-Z0-9\s])(?!.*\s).{12,}$"
                                                title="Password must be at least 12 characters long and contain at least 1 number, 1 capital letter, and 1 special character."
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                                        </div>

                                        <input type="hidden" name="account_id" value="<%= account_id %>">

                                        <button type="submit"
                                            class="w-full bg-indigo-600 text-white py-2 rounded-lg font-semibold hover:bg-indigo-700 transition duration-150 ease-in-out">
                                            Change Password
                                        </button>
                                    </form>


                                </div>